{"mappings":"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","sources":["src/modules/firebase.ts","src/modules/profile.ts","src/modules/gui.ts"],"sourcesContent":["export const url = \"https://js2-social-default-rtdb.europe-west1.firebasedatabase.app/users\";\nconst currentUser = localStorage.getItem('user');\n\nexport type firebaseUser = {\n    username: string,\n    avatar: string,\n    password: string,\n    posts: postObject\n}\n\nexport type postObject = {\n    message: string,\n}\n\n// get all users from firebase\nexport async function listAllUsers(userListDiv: HTMLDivElement) {\n\n    const response = await fetch(url + '.json');\n    const data = await response.json();\n    console.log(data);\n    const usersArray = Object.values(data);\n    const usersKeys = Object.keys(data);\n\n    getUsersList(usersArray)\n    function getUsersList(array){\n        let index:number = 0;\n\n        array.forEach((list: firebaseUser) => {\n            const { username, avatar, } = list;\n\n            if (username != currentUser) {\n                const namn = document.createElement('h3');\n                namn.innerText = username;\n                const img = document.createElement('img');\n                img.src = avatar;\n                img.style.maxHeight = '100px';\n                const userCard = document.createElement('div');\n                userCard.append(namn, img)\n                userListDiv.append(userCard);\n                userCard.classList.add('user-card')\n\n                const usersId = usersKeys[index];\n    \n                img.addEventListener('click', () => {\n                    localStorage.setItem('viewUser', username);\n                    localStorage.setItem('viewUserAvatar', avatar)\n                    localStorage.setItem('viewedUserId', usersId)\n                    setTimeout(() => {\n                        location.assign('../html/userPage.html')\n                    }, 100);\n                })\n            }\n\n            index++; \n        })\n        \n}}\n\nexport async function deleteUser(id, container:HTMLDivElement) {\n\n    // const url = `https://js2-social-default-rtdb.europe-west1.firebasedatabase.app/users/${currentId}.json`;\n\n    const response = await fetch(url + `/${id}.json`, { method: 'DELETE' });\n    const data = await response.json();\n    console.log(data, \"user is removed\");\n\n    container.innerHTML = '';\n}\n\n\n//för att hämta userId\nexport async function getId(user) {\n\n    const response = await fetch(url + '.json');\n    const data = await response.json();\n    console.log(data);\n\n    const usersArray = Object.values(data);\n    const keyArr = Object.keys(data);\n\n    getUserId(usersArray)\n    function getUserId(array){\n        let index = 0; \n\n        array.forEach((list: firebaseUser) => {\n            const { username } = list;\n\n            if (username === user) {\n                const userId = keyArr[index];\n                console.log(userId);\n                localStorage.setItem('id', userId);\n    \n            }\n            index++;\n        })\n    }\n}\n\nexport async function deletePosts(userId) {\n    const response = await fetch(url + `/${userId}/posts.json`, { method: 'DELETE' });\n    const data = await response.json();\n    console.log(data, \"posts are removed\");\n\n    location.reload();\n}","import { viewProfile } from \"./gui\";\nimport { listAllUsers } from \"./firebase\";\nimport { url } from \"./firebase\";\nimport { firebaseUser } from \"./firebase\";\nimport { deleteUser } from \"./firebase\";\nimport { deletePosts } from \"./firebase\";\n\nconst container = document.querySelector('#profile-container') as HTMLDivElement;\nconst userName = document.querySelector('#username-txt') as HTMLElement;\nconst img = document.querySelector('#user-avatar') as HTMLImageElement;\nconst usersContainer = document.querySelector('#other-users-container') as HTMLDivElement;\nconst removeBtn = document.querySelector('#remove-btn') as HTMLButtonElement;\nconst postInput = document.querySelector('#textarea') as HTMLInputElement;\nconst publishBtn = document.querySelector('#publish-btn') as HTMLButtonElement;\nconst postCard = document.querySelector('#post-card') as HTMLElement;\nconst deletePostsBtn = document.querySelector('#remove-posts') as HTMLButtonElement;\n\nconst currentUser = localStorage.getItem('user');\nconst currentAvatar = localStorage.getItem('avatar');\nconst currentId = localStorage.getItem('id');\n\n// getId()\ngetProfile();\nsetTimeout(() => {\n    getUsersPost();\n}, 300);\nviewProfile(currentAvatar, currentUser, img, userName);\nlistAllUsers(usersContainer); \n// viewAllUsers();\n\n// async function viewProfile() {\n//     img.src = `${currentAvatar}`;\n//     userName.innerText = `${currentUser}`;\n\n// //     container.append(img);\n// //     console.log(currentId)\n// //     console.log(currentUser);\n// // }\n\n// // get all users from firebase\n// async function viewAllUsers() {\n\n//     const url = \"https://js2-social-default-rtdb.europe-west1.firebasedatabase.app/users.json\";\n\n//     const response = await fetch(url);\n//     const data = await response.json();\n//     console.log(data);\n//     const usersArray = Object.values(data);\n//     const usersKeys = Object.keys(data);\n\n//     for (let i = 0; i < usersArray.length; i++) {\n\n//         const { username, password, avatar, } = usersArray[i];\n\n//         if (username != currentUser) {\n//             const namn = document.createElement('h3');\n//             namn.innerText = username;\n//             const img = document.createElement('img');\n//             img.src = avatar;\n//             img.style.maxHeight = '100px';\n//             const userCard = document.createElement('div');\n//             userCard.append(namn, img)\n//             usersContainer.append(userCard);\n//             userCard.classList.add('user-card')\n\n//             const usersId = usersKeys[i];\n\n//             img.addEventListener('click', () => {\n//                 localStorage.setItem('viewUser', username);\n//                 localStorage.setItem('viewUserAvatar', avatar)\n//                 localStorage.setItem('viewedUserId', usersId)\n//                 setTimeout(() => {\n//                     location.assign('../html/userProfile.html')\n//                 }, 100);\n//             })\n//         }\n//     }\n\n// }\n\nremoveBtn.addEventListener('click', () => {\n    deleteUser(currentId, container);\n    setTimeout(() => {\n        location.assign('../html.html')\n    }, 300);\n})\n\ndeletePostsBtn.addEventListener('click', () => {\n    deletePosts(currentId);\n})\n\n//skapa en post\nasync function addPost(obj: Object) {\n    // const url = `https://js2-social-default-rtdb.europe-west1.firebasedatabase.app/users/${currentId}/posts.json`;\n    if (obj != '') {\n\n        const init = {\n            method: 'POST',\n            body: JSON.stringify(obj),\n            headers: {\n                'Content-type': \"application/json; charset=UTF-8\"\n            }\n        };\n\n        const response = await fetch(url + `/${currentId}/posts.json`, init);\n        const data = await response.json();\n        console.log(data);\n    }\n}\n\n//\npublishBtn.addEventListener('click', (event) => {\n    event.preventDefault();\n    const newPost = postInput.value;\n    console.log(newPost);\n    addPost(newPost);\n    setTimeout(() => {\n        getUsersPost()\n    }, 200);\n    postInput.value = '';\n})\n\n//hämta currentUsers posts\nasync function getUsersPost() {\n\n    const response = await fetch(url + `/${currentId}/posts.json`);\n    const data = await response.json();\n    \n    if(data != null){\n    console.log(data);\n    const postArray = Object.values(data);\n\n    console.log(postArray)\n\n    showPosts(postArray);\n    }else{\n        postCard.innerText = \"No posts yet\"\n    }\n}\n\nconsole.log(currentId);\n\nfunction showPosts(arr) {\n\n    postCard.innerHTML = '';\n\n    arr.forEach((element: String) => {\n        const postDiv = document.createElement('div');\n        postDiv.classList.add('post-card');\n        const postTxt = document.createElement('p');\n        postTxt.innerText = `${element}`;\n\n        // const deleteBtn = document.createElement('button');\n        // deleteBtn.innerText = \"delete post\";\n        // deleteBtn.addEventListener('click', () => {\n        //     getPostsId(arr2);\n        // })\n        // postDiv.append(postTxt, deleteBtn)\n        postDiv.append(postTxt)\n        postCard.prepend(postDiv);\n    });\n\n}\n\n// async function deleteUser() {\n\n//     // const url = `https://js2-social-default-rtdb.europe-west1.firebasedatabase.app/users/${currentId}.json`;\n\n//     const response = await fetch(url + `/${currentId}.json`, { method: 'DELETE' });\n//     const data = await response.json();\n//     console.log(data, \"user is removed\");\n\n//     container.innerHTML = '';\n// }\n\n\n\nexport async function getId() {\n\n    postCard.innerHTML = '';\n\n    const response = await fetch(url + '.json');\n    const data = await response.json();\n    console.log(data);\n    const usersArray = Object.values(data);\n    const usersKeys = Object.keys(data);\n\n    getUserId(usersArray)\n    function getUserId(array){\n        let index = 0;\n\n        array.forEach((list: firebaseUser) => {\n            const { username } = list;\n        \n                if (username === currentUser) {\n                    const userId = usersKeys[index];\n                    console.log(userId);\n                    localStorage.setItem('id', userId);\n                }\n\n                index++; \n                console.log(currentId);\n                \n            })\n            \n        }\n        \n}\n\nconsole.log(currentId)\n\nasync function getProfile() {\n\n    const response = await fetch(url + '.json');\n    const data = await response.json();\n    console.log(data);\n\n    const usersArray = Object.values(data);\n    const keyArr = Object.keys(data);\n\n    getUserId(usersArray)\n    function getUserId(array){\n        let index = 0; \n\n        array.forEach((list: firebaseUser) => {\n            const { username } = list;\n\n            if (username === currentUser) {\n                const userId = keyArr[index];\n                console.log(userId);\n                localStorage.setItem('id', userId);\n    \n            }\n            index++;\n        })\n    }\n}","export async function viewProfile(avatar, user, img:HTMLImageElement, username:HTMLElement) {\n    img.src = avatar;\n    username.innerText = user;\n}\n\n"],"names":["$14f6629ccf7de9b8$export$128fa18b7194ef","$14f6629ccf7de9b8$var$currentUser","localStorage","getItem","async","$14f6629ccf7de9b8$export$7d0f10f273c0438a","id","container","response","fetch","method","data","json","console","log","innerHTML","$14f6629ccf7de9b8$export$93623cb5800553b","userId","location","reload","$c5272c87d5623534$var$container","document","querySelector","$c5272c87d5623534$var$userName","$c5272c87d5623534$var$img","$c5272c87d5623534$var$usersContainer","$c5272c87d5623534$var$removeBtn","$c5272c87d5623534$var$postInput","$c5272c87d5623534$var$publishBtn","$c5272c87d5623534$var$postCard","$c5272c87d5623534$var$deletePostsBtn","$c5272c87d5623534$var$currentUser","$c5272c87d5623534$var$currentAvatar","$c5272c87d5623534$var$currentId","$c5272c87d5623534$var$getUsersPost","postArray","Object","values","arr","forEach","element","postDiv","createElement","classList","add","postTxt","innerText","append","prepend","usersArray","keyArr","keys","array","index","list","username","setItem","getUserId","$c5272c87d5623534$var$getProfile","setTimeout","avatar","user","img","src","userListDiv","usersKeys","namn","style","maxHeight","userCard","usersId","addEventListener","assign","getUsersList","event","preventDefault","newPost","value","obj","init","body","JSON","stringify","headers","$c5272c87d5623534$var$addPost"],"version":3,"file":"profile.04ebc593.js.map"}