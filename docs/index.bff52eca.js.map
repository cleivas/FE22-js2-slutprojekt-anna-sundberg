{"mappings":"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","sources":["node_modules/@parcel/runtime-js/lib/helpers/bundle-manifest.js","node_modules/@parcel/runtime-js/lib/runtime-592b87910df4f6db.js","src/modules/firebase.ts","src/index.ts","node_modules/@parcel/runtime-js/lib/runtime-5d95389c327c7962.js","node_modules/@parcel/runtime-js/lib/runtime-ab8cb11bab3eefc4.js","node_modules/@parcel/runtime-js/lib/runtime-b96fe67e5d519c4c.js"],"sourcesContent":["\"use strict\";\n\nvar mapping = {};\n\nfunction register(pairs) {\n  var keys = Object.keys(pairs);\n\n  for (var i = 0; i < keys.length; i++) {\n    mapping[keys[i]] = pairs[keys[i]];\n  }\n}\n\nfunction resolve(id) {\n  var resolved = mapping[id];\n\n  if (resolved == null) {\n    throw new Error('Could not resolve bundle with id ' + id);\n  }\n\n  return resolved;\n}\n\nmodule.exports.register = register;\nmodule.exports.resolve = resolve;","require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"l1gf1\\\":\\\"index.bff52eca.js\\\",\\\"dFjjW\\\":\\\"koala.381c436e.svg\\\",\\\"z2aJN\\\":\\\"duck.35625f35.svg\\\",\\\"9jQRK\\\":\\\"penguin.cbd7ba22.svg\\\"}\"));","export const url = \"https://js2-social-default-rtdb.europe-west1.firebasedatabase.app/users\";\nconst currentUser = localStorage.getItem('user');\n\nexport type firebaseUser = {\n    username: string,\n    avatar: string,\n    password: string,\n    posts: postObject\n}\n\nexport type postObject = {\n    message: string,\n}\n\n// get all users from firebase & show on profile page \nexport async function listAllUsers(userListDiv: HTMLDivElement) {\n\n    const response = await fetch(url + '.json');\n    const data = await response.json();\n    console.log(data);\n    const usersArray = Object.values(data);\n    const usersKeys = Object.keys(data);\n\n    getUsersList(usersArray)\n    function getUsersList(array) {\n        let i: number = 0;\n\n        array.forEach((list: firebaseUser) => {\n            const { username, avatar, } = list;\n\n            if (username != currentUser) {\n                const namn = document.createElement('h3');\n                namn.innerText = username;\n                const img = document.createElement('img');\n                img.src = avatar;\n                img.style.maxHeight = '100px';\n                const userCard = document.createElement('div');\n                userCard.append(namn, img)\n                userListDiv.append(userCard);\n                userCard.classList.add('user-card')\n\n                const usersId = usersKeys[i];\n\n                img.addEventListener('click', () => {\n                    localStorage.setItem('viewUser', username);\n                    localStorage.setItem('viewUserAvatar', avatar)\n                    localStorage.setItem('viewedUserId', usersId)\n                    setTimeout(() => {\n                        window.location.href = \"../html/userPage.html\"\n                    }, 100);\n                })\n            }\n\n            i++;\n        })\n\n    }\n}\n\n//delete user from firebase\nexport async function deleteUser(id, container: HTMLDivElement) {\n\n    const response = await fetch(url + `/${id}.json`, { method: 'DELETE' });\n    const data = await response.json();\n    console.log(data, \"user is removed\");\n\n    container.innerHTML = '';\n}\n\n//remove all posts from logged in user\nexport async function deletePosts(userId) {\n    const response = await fetch(url + `/${userId}/posts.json`, { method: 'DELETE' });\n    const data = await response.json();\n    console.log(data, \"posts are removed\");\n\n    location.reload();\n}","import { url } from \"./modules/firebase\";\n\nlet userAvatar: string = '';\nlet newUser: boolean;\nlet addNewUser: boolean;\n\n//when clicking sign in\nconst signIn = document.querySelector('#sign-in') as HTMLButtonElement;\nconst signInDiv = document.querySelector('#user-input') as HTMLElement;\nsignIn.addEventListener('click', () => {\n    newUser = false;\n    console.log(\"OK du ska logga in\");\n    signUp.style.display = 'none';\n    signInDiv.style.display = 'flex';\n    signInDiv.style.border = 'black 2px solid';\n    signIn.style.display = 'none'\n});\n\n//when clicking sign up\nconst submitBtn = document.querySelector('#submit-btn') as HTMLButtonElement;\nconst signUp = document.querySelector('#sign-up') as HTMLButtonElement;\n\nsignUp.addEventListener('click', () => {\n    newUser = true;\n    console.log(newUser)\n    signUp.style.display = 'none';\n    signInDiv.style.display = 'flex';\n    const avatarDiv = document.createElement('div');\n    console.log(\"OK, du ska skapa en user\");\n    signIn.style.display = 'none';\n    submitBtn.innerText = \"Create User\";\n    const koala = document.createElement('img');\n    let koalaUrl = new URL('./media/koala.svg', import.meta.url);\n    koala.src = koalaUrl.href;\n\n    const duck = document.createElement('img');\n    let duckUrl = new URL('./media/duck.svg', import.meta.url);\n    duck.src = duckUrl.href;\n\n    const penguin = document.createElement('img');\n    let penguinUrl = new URL('./media/penguin.svg', import.meta.url);\n    penguin.src = penguinUrl.href;\n\n    const text = document.createElement('h3');\n    text.innerText = \"Choose your avatar by clicking the one you want\";\n\n    avatarDiv.append(koala, duck, penguin);\n    signInDiv.prepend(text, avatarDiv);\n\n    koala.addEventListener('click', () => {\n        console.log(\"You chose koala\")\n        userAvatar = 'https://www.reshot.com/preview-assets/icons/NX7HW2CBSF/koala-NX7HW2CBSF.svg';\n        duck.style.display = 'none';\n        penguin.style.display = 'none';\n    })\n\n    duck.addEventListener('click', () => {\n        console.log(\"You chose duck\")\n        userAvatar = 'https://www.reshot.com/preview-assets/icons/RYZ2P59AGC/duck-RYZ2P59AGC.svg';\n        koala.style.display = 'none';\n        penguin.style.display = 'none';\n    })\n\n    penguin.addEventListener('click', () => {\n        console.log(\"You chose penguin\");\n        userAvatar = 'https://www.reshot.com/preview-assets/icons/3BTWMSPU95/penguin-3BTWMSPU95.svg';\n        koala.style.display = 'none';\n        duck.style.display = 'none';\n    })\n});\n\n//när man ska logga in eller skapa - kolla användarnamn o lösen\nconst inputForm = document.querySelector('#input-form') as HTMLFormElement;\ninputForm.addEventListener('submit', (event) => {\n    event.preventDefault();\n    checkUser();\n})\n\nasync function checkUser() {\n    let usernameInput = document.querySelector('#username') as HTMLInputElement;\n    let passwordInput = document.querySelector('#password') as HTMLInputElement;\n    const error = document.querySelector('#error-message') as HTMLElement;\n\n    const response = await fetch(url + '.json');\n    const data = await response.json();\n    console.log(data);\n\n    const usersArray = Object.values(data);\n    const keyArr = Object.keys(data);\n\n    if (newUser == false) {\n\n        checkLogin(usersArray)\n        function checkLogin(array) {\n\n            for (let i = 0; i < array.length; i++) {\n\n                const { username, password, avatar } = array[i];\n\n                if (usernameInput.value != username || passwordInput.value != password) {\n                    error.innerText = \"Wrong username or password\";\n                }\n\n                else if (usernameInput.value == username && passwordInput.value == password) {\n                    error.innerText = '';\n                    console.log('hittade user');\n                    const userId = keyArr[i];\n                    localStorage.setItem('user', usernameInput.value);\n                    localStorage.setItem('password', passwordInput.value);\n                    localStorage.setItem('avatar', avatar);\n                    localStorage.setItem('id', userId);\n\n                    setTimeout(() => {\n                        location.assign(\"../html/profile.html\");\n                    }, 400);\n                    break\n                }\n                else {\n                    console.log('ingen user hittades')\n                    error.innerText = \"no user found :(\"\n                }\n            }\n        }\n    }\n\n    if (newUser == true) {\n        signUpNewUser(usersArray)\n\n        function signUpNewUser(array) {\n\n            for (let i = 0; i < array.length; i++) {\n\n                const { username, password } = array[i]\n\n                if (usernameInput.value == '' || passwordInput.value == '' || userAvatar == '') {\n                    alert('fyll i alla inputs');\n                    break;\n                }\n                if (usernameInput.value == username && passwordInput.value == password) {\n                    console.log('did you mean to sign in instead?');\n                    error.innerText = \"User already exists, did you mean to sign in instead?\"\n                    addNewUser = false;\n                    break;\n                }\n                else if (usernameInput.value == username) {\n                    console.log('user already exists, try a different username');\n                    error.innerText = \"This name is taken :(\"\n                    addNewUser = false;\n                    break\n                }\n\n                else if (usernameInput.value != username) {\n                    console.log('ingen user hittades, ny skall skapas')\n                    addNewUser = true;\n                }\n            }\n        }\n    }\n\n    if (addNewUser == true) {\n\n        const createUser = {\n            username: usernameInput.value,\n            password: passwordInput.value,\n            avatar: userAvatar,\n        }\n\n        addUser(createUser);\n\n        async function addUser(obj: object) {\n\n            const init = {\n                method: 'POST',\n                body: JSON.stringify(obj),\n                headers: {\n                    'Content-type': \"application/json; charset=UTF-8\"\n                }\n            };\n\n            const response = await fetch(url + '.json', init);\n            const data = await response.json();\n            console.log(data);\n        }\n\n        localStorage.setItem('user', usernameInput.value)\n        localStorage.setItem('password', passwordInput.value);\n        localStorage.setItem('avatar', userAvatar);\n        setTimeout(() => {\n            location.assign('../html/profile.html')\n        }, 600)\n    }\n}\n\n","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"dFjjW\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"z2aJN\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"9jQRK\")).toString();"],"names":["$18c11f3350a906ea$export$6503ec6e8aabbaf","$18c11f3350a906ea$export$f7ad0328861e2f03","$18c11f3350a906ea$var$mapping","pairs","keys","Object","i","length","id","resolved","Error","parcelRequire","register","JSON","parse","$14f6629ccf7de9b8$export$128fa18b7194ef","localStorage","getItem","$b4e14b6b8da86996$var$newUser","$b4e14b6b8da86996$var$addNewUser","$b4e14b6b8da86996$var$userAvatar","$b4e14b6b8da86996$var$signIn","document","querySelector","$b4e14b6b8da86996$var$signInDiv","addEventListener","console","log","$b4e14b6b8da86996$var$signUp","style","display","border","$b4e14b6b8da86996$var$submitBtn","$87a7588a6b0e2328$exports","URL","resolve","url","toString","$ed3a36f4cc552c20$exports","$22362bae294cd283$exports","avatarDiv","createElement","innerText","koala","koalaUrl","src","href","duck","duckUrl","penguin","penguinUrl","text","append","prepend","event","preventDefault","async","usernameInput","passwordInput","error","response","fetch","data","json","usersArray","values","keyArr","checkLogin","array","username","password","avatar","value","userId","setItem","setTimeout","location","assign","signUpNewUser","alert","addUser","obj","init","method","body","stringify","headers","$b4e14b6b8da86996$var$checkUser"],"version":3,"file":"index.bff52eca.js.map"}