{"mappings":"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","sources":["node_modules/@parcel/runtime-js/lib/helpers/bundle-manifest.js","node_modules/@parcel/runtime-js/lib/runtime-9e75a82eb5934701.js","src/modules/firebase.ts","index.ts","node_modules/@parcel/runtime-js/lib/runtime-5d95389c327c7962.js","node_modules/@parcel/runtime-js/lib/runtime-ab8cb11bab3eefc4.js","node_modules/@parcel/runtime-js/lib/runtime-b96fe67e5d519c4c.js"],"sourcesContent":["\"use strict\";\n\nvar mapping = {};\n\nfunction register(pairs) {\n  var keys = Object.keys(pairs);\n\n  for (var i = 0; i < keys.length; i++) {\n    mapping[keys[i]] = pairs[keys[i]];\n  }\n}\n\nfunction resolve(id) {\n  var resolved = mapping[id];\n\n  if (resolved == null) {\n    throw new Error('Could not resolve bundle with id ' + id);\n  }\n\n  return resolved;\n}\n\nmodule.exports.register = register;\nmodule.exports.resolve = resolve;","require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"6evGa\\\":\\\"index.958cfcad.js\\\",\\\"dFjjW\\\":\\\"koala.381c436e.svg\\\",\\\"z2aJN\\\":\\\"duck.35625f35.svg\\\",\\\"9jQRK\\\":\\\"penguin.cbd7ba22.svg\\\"}\"));","export const url = \"https://js2-social-default-rtdb.europe-west1.firebasedatabase.app/users\";\nconst currentUser = localStorage.getItem('user');\n\nexport type firebaseUser = {\n    username: string,\n    avatar: string,\n    password: string,\n    posts: postObject\n}\n\nexport type postObject = {\n    message: string,\n}\n\n// get all users from firebase\nexport async function listAllUsers(userListDiv: HTMLDivElement) {\n\n    const response = await fetch(url + '.json');\n    const data = await response.json();\n    console.log(data);\n    const usersArray = Object.values(data);\n    const usersKeys = Object.keys(data);\n\n    getUsersList(usersArray)\n    function getUsersList(array){\n        let index:number = 0;\n\n        array.forEach((list: firebaseUser) => {\n            const { username, avatar, } = list;\n\n            if (username != currentUser) {\n                const namn = document.createElement('h3');\n                namn.innerText = username;\n                const img = document.createElement('img');\n                img.src = avatar;\n                img.style.maxHeight = '100px';\n                const userCard = document.createElement('div');\n                userCard.append(namn, img)\n                userListDiv.append(userCard);\n                userCard.classList.add('user-card')\n\n                const usersId = usersKeys[index];\n    \n                img.addEventListener('click', () => {\n                    localStorage.setItem('viewUser', username);\n                    localStorage.setItem('viewUserAvatar', avatar)\n                    localStorage.setItem('viewedUserId', usersId)\n                    setTimeout(() => {\n                        location.assign('../html/userPage.html')\n                    }, 100);\n                })\n            }\n\n            index++; \n        })\n        \n}}\n\nexport async function deleteUser(id, container:HTMLDivElement) {\n\n    // const url = `https://js2-social-default-rtdb.europe-west1.firebasedatabase.app/users/${currentId}.json`;\n\n    const response = await fetch(url + `/${id}.json`, { method: 'DELETE' });\n    const data = await response.json();\n    console.log(data, \"user is removed\");\n\n    container.innerHTML = '';\n}\n\n\n//för att hämta userId\nexport async function getId(user) {\n\n    const response = await fetch(url + '.json');\n    const data = await response.json();\n    console.log(data);\n\n    const usersArray = Object.values(data);\n    const keyArr = Object.keys(data);\n\n    getUserId(usersArray)\n    function getUserId(array){\n        let index = 0; \n\n        array.forEach((list: firebaseUser) => {\n            const { username } = list;\n\n            if (username === user) {\n                const userId = keyArr[index];\n                console.log(userId);\n                localStorage.setItem('id', userId);\n    \n            }\n            index++;\n        })\n    }\n}\n\nexport async function deletePosts(userId) {\n    const response = await fetch(url + `/${userId}/posts.json`, { method: 'DELETE' });\n    const data = await response.json();\n    console.log(data, \"posts are removed\");\n\n    location.reload();\n}","import { url } from \"./src/modules/firebase\";\nimport { firebaseUser } from \"./src/modules/firebase\";\n\nlet userAvatar:string = '';\n\n//when clicking sign in\nconst signIn = document.querySelector('#sign-in') as HTMLButtonElement;\nconst signInDiv = document.querySelector('#user-input') as HTMLElement;\nsignIn.addEventListener('click', () => {\n    newUser = false;\n    console.log(\"OK du ska logga in\");\n    signUp.style.display = 'none';\n    signInDiv.style.display = 'flex';\n    signInDiv.style.border = 'black 2px solid';\n    signIn.style.display = 'none'\n});\n\n//when clicking sign up\nconst submitBtn = document.querySelector('#submit-btn') as HTMLButtonElement;\nconst signUp = document.querySelector('#sign-up') as HTMLButtonElement;\nlet newUser: boolean = false;\nsignUp.addEventListener('click', () => {\n    newUser = true;\n    signUp.style.display = 'none'; \n    signInDiv.style.display = 'flex';\n    const avatarDiv = document.createElement('div');\n    console.log(\"OK, du ska skapa en user\");\n    signIn.style.display = 'none';\n    submitBtn.innerText = \"Create User\";\n    const koala = document.createElement('img');\n    let koalaUrl = new URL('./src/media/koala.svg', import.meta.url);\n    koala.src = koalaUrl.href;\n\n    const duck = document.createElement('img');\n    let duckUrl = new URL('./src//media/duck.svg', import.meta.url);\n    duck.src = duckUrl.href;\n\n    const penguin = document.createElement('img');\n    let penguinUrl = new URL('./src/media/penguin.svg', import.meta.url);\n    penguin.src = penguinUrl.href;\n\n    const text = document.createElement('h3');\n    text.innerText = \"Choose your avatar by clicking the one you want\";\n\n    avatarDiv.append(koala, duck, penguin);\n    signInDiv.prepend(text, avatarDiv);\n\n    koala.addEventListener('click', () => {\n        console.log(\"You chose koala\")\n        userAvatar = 'https://www.reshot.com/preview-assets/icons/NX7HW2CBSF/koala-NX7HW2CBSF.svg';\n        duck.style.display = 'none';\n        penguin.style.display = 'none';\n    })\n\n    duck.addEventListener('click', () => {\n        console.log(\"You chose duck\")\n        userAvatar = 'https://www.reshot.com/preview-assets/icons/RYZ2P59AGC/duck-RYZ2P59AGC.svg'; \n        koala.style.display = 'none';\n        penguin.style.display = 'none';\n    })\n\n    penguin.addEventListener('click', () => {\n        console.log(\"You chose penguin\");\n        userAvatar = 'https://www.reshot.com/preview-assets/icons/3BTWMSPU95/penguin-3BTWMSPU95.svg';\n        koala.style.display = 'none';\n        duck.style.display = 'none';\n    })\n});\n\n//när man ska logga in eller skapa - kolla användarnamn o lösen\nsubmitBtn.addEventListener('click', (event) => {\n    event.preventDefault();\n    checkUser();\n})\n\nlet addNewUser: boolean = false;\nasync function checkUser() {\n    let usernameInput = document.querySelector('#username') as HTMLInputElement;\n    let passwordInput = document.querySelector('#password') as HTMLInputElement;\n\n    const response = await fetch(url + '.json');\n    const data = await response.json();\n    console.log(data);\n    const usersArray = Object.values(data);\n    const keyArr = Object.keys(data);\n\n    if (newUser == false) {\n        \n\n        for (let i = 0; i < usersArray.length; i++) {\n            \n            const { username, password, avatar } = usersArray[i];\n\n            if (usernameInput.value == '' || passwordInput.value == '') {\n                alert('fyll i alla inputs');\n                break;\n            }\n            \n            if (usernameInput.value == username && passwordInput.value == password) {\n                console.log('hittade user');\n                console.log(username, password, avatar, keyArr[i]);\n                const userId = keyArr[i];\n                localStorage.setItem('user', usernameInput.value);\n                localStorage.setItem('password', passwordInput.value);\n                localStorage.setItem('avatar', avatar);\n                localStorage.setItem('id', userId);\n            \n                setTimeout(() => {\n                location.assign(\"../html/profile.html\");\n                }, 1000);\n                break\n            }\n            \n            else\n                console.log('ingen user hittades')\n        }\n    }\n    else if (newUser == true) {\n        for (let i = 0; i < usersArray.length; i++) {\n            //TS klagar här men det fungerar ändå:\n            const { username, password, avatar } = usersArray[i];\n\n            console.log(usernameInput.value, username, passwordInput.value, password);\n\n            if (usernameInput.value == '' || passwordInput.value == '' || userAvatar == '') {\n                alert('fyll i alla inputs');\n                break;\n            }\n\n            if (usernameInput.value == username && passwordInput.value == password) {\n                console.log('did you mean to sign in instead?');\n                addNewUser = false;\n                break;\n            }\n            else if (usernameInput.value == username) {\n                console.log('user already exists, try a different username');\n               addNewUser = false;\n                break\n            }\n\n            else if (usernameInput.value != username ) {\n                console.log('ingen user hittades, ny skall skapas')\n                addNewUser = true;\n            }\n            \n        }\n\n        \n    }\n\n    if(addNewUser == true){\n\n        const createUser = {\n            username: usernameInput.value,\n            password: passwordInput.value,\n            avatar: userAvatar,\n            }\n\n        addUser(createUser);\n\n        async function addUser(obj:object) {\n\n            const init = {\n                method: 'POST',\n                body: JSON.stringify(obj),\n                headers: {\n                    'Content-type': \"application/json; charset=UTF-8\"\n                }\n            };\n\n            const response = await fetch(url + '.json', init);\n            const data = await response.json();\n            console.log(data);\n        }\n    \n        localStorage.setItem('user', usernameInput.value)\n        localStorage.setItem('password', passwordInput.value);\n        localStorage.setItem('avatar', userAvatar);\n        setTimeout( () => {\n            location.assign('../html/profile.html')\n        }, 600)\n    }\n}\n\n\n","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"dFjjW\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"z2aJN\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"9jQRK\")).toString();"],"names":["$18c11f3350a906ea$export$6503ec6e8aabbaf","$18c11f3350a906ea$export$f7ad0328861e2f03","$18c11f3350a906ea$var$mapping","pairs","keys","Object","i","length","id","resolved","Error","parcelRequire","register","JSON","parse","$14f6629ccf7de9b8$export$128fa18b7194ef","localStorage","getItem","$543d6d2a56ed7d8d$var$userAvatar","$543d6d2a56ed7d8d$var$signIn","document","querySelector","$543d6d2a56ed7d8d$var$signInDiv","addEventListener","$543d6d2a56ed7d8d$var$newUser","console","log","$543d6d2a56ed7d8d$var$signUp","style","display","border","$543d6d2a56ed7d8d$var$submitBtn","$87a7588a6b0e2328$exports","URL","resolve","url","toString","$ed3a36f4cc552c20$exports","$22362bae294cd283$exports","avatarDiv","createElement","innerText","koala","koalaUrl","src","href","duck","duckUrl","penguin","penguinUrl","text","append","prepend","event","preventDefault","async","usernameInput","passwordInput","response","fetch","data","json","usersArray","values","keyArr","username","password","avatar","value","alert","userId","setItem","setTimeout","location","assign","$543d6d2a56ed7d8d$var$addNewUser","addUser","obj","init","method","body","stringify","headers","$543d6d2a56ed7d8d$var$checkUser"],"version":3,"file":"index.958cfcad.js.map"}